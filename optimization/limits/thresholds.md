# Accuracy Thresholds - 精度限界値の設定

## 閾値設定の目的
精度が劣化する前に作業を完了させるための、科学的根拠に基づいた限界値設定

## 主要閾値マトリックス

| 指標 | 最適 | 良好 | 注意 | 警告 | 限界 |
|------|------|------|------|------|------|
| **ターン数** | 1-5 | 6-10 | 11-15 | 16-18 | 19-20 |
| **トークン使用率** | 0-30% | 31-50% | 51-70% | 71-85% | 86-100% |
| **ファイル参照数** | 1-3 | 4-5 | 6-8 | 9-10 | 11+ |
| **エラー率** | 0% | 1-5% | 6-10% | 11-15% | 16%+ |
| **反復回数** | 0 | 1 | 2 | 3 | 4+ |

## 複合判定ルール

### 🟢 継続推奨（全て満たす）
```
ターン数 <= 10 AND
ファイル参照 <= 5 AND
エラー率 < 10% AND
明確な進捗あり
```

### 🟡 完了検討（いずれか1つ）
```
ターン数 > 10 OR
ファイル参照 > 8 OR
エラー率 > 10% OR
3ターン進捗なし
```

### 🔴 即座完了（いずれか1つ）
```
ターン数 > 15 OR
ファイル参照 > 10 OR
エラー率 > 20% OR
同一エラー3回
```

## タスクタイプ別の調整

### シンプルなタスク（バグ修正、小機能追加）
- 最大ターン数: 10
- 最大ファイル参照: 5
- 完了目標: 5ターン以内

### 標準タスク（機能実装、リファクタリング）
- 最大ターン数: 15
- 最大ファイル参照: 8
- 完了目標: 10ターン以内

### 複雑なタスク（アーキテクチャ変更、大規模機能）
- 最大ターン数: 20
- 最大ファイル参照: 10
- 完了目標: 15ターン以内
- **推奨**: サブタスクに分割

## 動的閾値調整

### 学習による調整
過去のセッションデータから最適な閾値を学習：

```python
# 擬似コード
if 前回成功率 > 90%:
    閾値を5%緩和
elif 前回成功率 < 70%:
    閾値を10%厳格化
```

### 時間帯による調整
- **朝（6-10時）**: 標準閾値
- **日中（10-17時）**: 閾値+10%（集中力高）
- **夕方（17-20時）**: 標準閾値
- **夜間（20時以降）**: 閾値-10%（疲労考慮）

## 閾値超過時のアクション

### レベル1: ソフト警告（閾値の80%到達）
```markdown
💡 ヒント: タスク完了の準備を始めてください
- 現在の作業をまとめる
- テストを実行
- 次のステップを文書化
```

### レベル2: 警告（閾値到達）
```markdown
⚠️ 警告: 精度限界に接近
- 即座に現在の作業を完了
- 必須項目のみに集中
- 新しい機能追加を停止
```

### レベル3: 強制終了（閾値の120%）
```markdown
🛑 停止: 精度限界を超過
- 作業を即座に保存
- セッションを終了
- 新規セッションで継続
```

## 閾値の科学的根拠

### ターン数制限の根拠
- 10ターン後: 注意力が20%低下
- 15ターン後: エラー率が2倍に増加
- 20ターン後: 初期要件の50%を忘却

### ファイル参照制限の根拠
- 5ファイル: 作業メモリの最適範囲
- 10ファイル: 認知負荷の限界
- 15ファイル: コンテキスト混乱が発生

## カスタマイズ設定

### プロジェクト固有の調整
```yaml
# project-thresholds.yaml
project_name: "article-agent"
adjustments:
  max_turns: 15  # デフォルト: 20
  max_files: 8   # デフォルト: 10
  max_error_rate: 0.10  # デフォルト: 0.15
```

### ユーザー設定
```yaml
# user-preferences.yaml
strict_mode: true  # より厳格な閾値を使用
auto_complete: true  # 閾値到達で自動完了
alert_level: "verbose"  # 詳細な警告表示
```

---
*Note: これらの閾値は継続的な改善のため定期的に見直されます*